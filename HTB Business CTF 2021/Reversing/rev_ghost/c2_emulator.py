import socket
import sys
import time
from Crypto.Cipher import AES
import binascii

def decrypt(data):
    #data = binascii.unhexlify(hex)
    key = binascii.unhexlify('3132333435363132333435363132333435363132333435363132333435363132')
    nonce, tag = data[:12], data[-16:]
    cipher = AES.new(key, AES.MODE_GCM, nonce)
    dt = cipher.decrypt_and_verify(data[12:-16], tag)
    return dt

def main():
    # Create a TCP/IP socket
    sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    sock.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)
    addr = '10.0.0.1'
    port = 443
    # Bind the socket to the port
    server_address = (addr, port)
    print('starting up on {} port {}'.format(addr,port))
    sock.bind(server_address)

    # Listen for incoming connections
    sock.listen(1)

    while True:
        # Wait for a connection
        print('waiting for a connection')
        connection, client_address = sock.accept()

        try:
            print('connection from', client_address)

            # Receive the data in small chunks and retransmit it
            while True:
                data_length = connection.recv(4)
                print(data_length);
                data_length_int = int.from_bytes(data_length,"little")
                print('next chung of data length: {:d}'.format(data_length_int))
                if data_length:
                    print('awaiting further data')
                    data = connection.recv(data_length_int)
                    if data:
                        dt = decrypt(data)
                        print(dt)
                        if (dt == b'yOaw1fs6'):
                            time.sleep(5.0)
                            out_data_len = binascii.unhexlify('1e000000')
                            print('Sending data length: 30')
                            connection.sendall(out_data_len)
                            time.sleep(5.0)
                            #encrypted_out_data = binascii.unhexlify('81d52e54aed012240e17967d65cae0ac224cf5c3b7cfd2d9e10536c3e334')
                            encrypted_out_data = binascii.unhexlify('7af20edae5a8cb4710090affaed1f6ecaf36eea2ee654f3c91137a2c944d')
                            #encrypted_out_data = binascii.unhexlify('6d22699ad96fa0cb0b56f26e5cf1ff6e685f831c46fb31ea1f60c1926dfd')
                            decrypted_out_data = decrypt(encrypted_out_data)
                            print('Sending data: {}'.format(decrypted_out_data))
                            connection.sendall(encrypted_out_data)
                            out_data_len = binascii.unhexlify('1c200000')
                            #out_data_len = binascii.unhexlify('23000000')
                            print('Sending data length: {:d}'.format(int.from_bytes(out_data_len,"little")))
                            connection.sendall(out_data_len)
                            time.sleep(5.0)
                            #encrypted_out_data = binascii.unhexlify('69f251e29a38f31bc38fb1437b88404fc0d4793abb7ed5c0b7e7d083c1d3c2cef79d29')
                            encrypted_out_data = binascii.unhexlify('a2bb3d8723606dfe3bd4c63586a585d46645924561f9a83d75ed80c3d374a894893d0e29482124d4809046bdb3207dda32befbacde90a2216a64fa1c40b2e25a3307793d0cdf76cfb7fe3e9f07312d1454a200a693502cd3043e7d9d158f58fbc8c889298fa1fd9ebe8bd0186fb4e02c01dda26d24b7f78d02cf7b321a71f1e50b7587c90f5340986bcceacdcde7ebc7336210a74fce2751bc2787c8fb6e1a5c66e43f7bb1d56d776b0ad9565853aa7b7c4137a981ee395ba7b21ea9a60696925371f7c5e9e6f771413523a09a6fa3d4ab6821bfccd1b6c8d968c465dac08a99035dabb53bb579353a54ab03db0f1d5a491f7754221e09c49a4bf8da3a513604440ab4952a33d4027ed9dfcd18f6cd119885129b3a0d33a5cb8018e68e111b419155240639da272b85d38291bcca860bba4040e954fad59ee03984d7786241a30b1746cb2e0e566d69bf36a1a691f5320ee4f669c835116fe6124f52f02f689791563c545bfc51a746cc903e5ff54f7fb9581dd3407f14c7acb5824b9f08ac19cd0dac145c14befea0394c893596a67eb816db9495d2185941b0cac0bed4debb9b14877d7a03cd3085440cb99b967de7f29328717ef9c01e94a7a8bfef9a397528540798c6ef614e7d2c6bb9a472a46b4f8b970be1f02999ddc5140056bdaefb883a07a5c2e74d6a22700bc9260d94151cbccd68c2359a9582d3708e57f5db6ab75397400de9685b4ca26adc274d0b679a359efcefeb1306594a5217a701b7ed59dcd2df6f115232cb722ac158a969b1d5ada59d3d0c0c813ac71c7838c23fb60d59993243bb57348130f2ec1e097163dd32a1337e31df743f3c1e2798ee028c6324a73e9e185d46dd491a580a10c2b19a726bfe847bf39d72b993d3f0acc8fd8a4cf20eaeca185a2fda6c695994b51279155e2ed15782aebbe741030f4d404ce8d2d92d0a502971fad204a5a0e114890d1720a4451aeec85c97d2060de4d1cf2f08c2342ff9404089d53c79e7727d071a49f870d5e574ff09ca5b1bcb255e76f28751dfb7378ae0214016af67f41860b1594f5bf3fbcc04b5f91a635ef75246020c127b4a7606248a506a26155a502c10e9b26b6197db6920591f96fec811fc839867228eccb6d0259de280e704d02fddb2413413f185e532bbefa9ebfb6bde4ef99914747295588d634d17c41cc234c4eb46d49dd23b0458624aef0dde6e85a8318ef7e5bc0a4dba50dd7461f63da9698cb0e80cf192ea0ff533e0d78e90ae51e58b7589ae64ef76ab14fb4f2e8a800f5d32d5ce660678d9925a8d896ed8072aa9e294520cd29d84e6ed98238a80576b63470b6e99cae660789aaf6181ed20f48245f225d1821390f4e905d6ff9fe6e1f5a6db7eff54582807fecd326c3ecc71a8c8bd75e10430ba034b58a738905faf177acf9aa68b712b717a077ffa0dd688ec692b7e58cc9fb4fddc746727adabd52e78afd9a18722c4e9c09f7cdc443baf94f23d4137f8e5d3de3add1b11602b8ad6698692ca20653b48b7fd348e0c506970316bb8d25b06b08102ec96afb004aa1ae3b286876769e3e17ee66ba5eb72694f44d0ce400f90f2d4660fc804b925612ec72dfbca411441b743ce980ac341c26e7f5cd111e0bbe7a75439aa9bd61791443a02b45661ac4b4b0cd2e38963a4efa769050d4f73a08bd5531c1e4ef66d7600f83269b9ae6ce49888a67c267620474f2aeb70ee1291ce46bfeaa395abb2a033fe1a2461bf160a7cf154769cc0d87dead53e39088ea42326ec8177d17dde017f8002f535598b36fae4b59e80d0ea2d12fa601147f64ef9117b632c8b366a3b9d5fd81b45bd6d4bbdb33bd7f3dfa6308b20f98a4dde503b07e985c673b7dfff8fbade26a3ba6c43c9d27207b108a5b670f666b8c5f0ddf67d4b9e8c5503c96761f9dc1510a1a33e557f46485f5ae61dca10c380938270f7387c641d61ab3f2b19c71f62694e6c5640bfb1899c59579a56460fcaa536332476108e4d6425796f66bdb4faaf1ba69798a795ce6d313b627544d06f99ae486000f9630337cb8ba3d54b4f2042e382ac1ae4dc5dc5afc32ea16196ce506f890ac92005c07ecde1661c2c98a4b1c4b9bd0c594a0cec2cd6ecfa0c4caba0ccea0ea6136d3a1242bb5264a9efaddbc95ea78151b248084bd62d5238e45edf579de2feedebf0950d164f4002404f0e514cb1b78c055b4f3895205c2b6e5eb3ff113f445aaa6b4b2c78a34c67dae8ac4b2c2cf54d9dfd465df7ac964e608c2ecbf5cf62abb4aa81358e5bfdfd13a7af45be909377d2fd352a1f34bcf19fee76baa1073c92ee5129cea66af3d582477ae6bb3a1c010f8c2a8319e79dfba73cb667b7d3fae61a5fe27702ce033c89cd4e159aa64e5ed6aebd12d096e9457e42b03c19e5bf830b48d56e143cda0fcd0e71f53931bf63a5c230d7e3acac669b9d838521479f5f915b6526f71eaa4d93499608a9b6ad71246013ea3678beb0883df187ffca3efa39c871d5feec2d79d319c80e137c433937f9e072df9b5f23e36e0217d441d0c87b294b3f6fda2f75caba488ed4f11335e698404a38fcb827cf696f219a0892d782516e9ff9963d1d2f7edc8843f83416ccdc1787c01c85850ea506401b2ed7d89c4f34d0e39830931b2215cc4e7dc1048aaccc3833bcd2f10afd7ab530a230ce1dedab80a3cb9b948e60f9fe1789685215276717951ced5187154ed0f61862d061262446e6bb47763b730c7ed21387791a6d3eaa42fb352002e5a75ec3bc7f79293b68dd0f1d6657bc55990c9d705b27cb500957354c2f5258a78033eb849ac2c9f4a9ee4011c832aa8ac67a7b5035227067812ecf8ff4016a6b3794c5157850035e2ec4653ce3e98e6e2c0e3305d00e0c2c32feaba514f43c175031197fbc2ff02a7232ebacf6128de1b007704e6f16b97e35e820eadee196d5d863dc73633b119b17363eda83413879f32254c0fb9a5a6f324cd009ebf7368b0958a14ff432b629728e03337098d6b1f168e9ae06c74984418e054dc604f6bf5b113a6f93e6b18e83706c1723071580299065db29747d5da8e84170f12133e234da563987b53e780eae08cab37d7139dee40230b0d77c241795e01d420640e5f7e883970560b0c7121b537ed852f3549941eb7dd0ca63defb32cf32e360ddd2e2ea244191b4b6033f43f339fb1141e300befeeb60242693a3b9b3aec27fbe8bc4c152936546ba1906954e683cddefb404cf6451477e9da55de7b3033e4f9ffd88810629eced313036efa483f32c3a61e6446022f86f889faae876a49d69c2117a8a1e6ceb2010ddb45eba951fb8ea99ad906f264b5e697659f264b94a0ba4f62152e559653692b30bd8ff59ebb07ef8edff28f3c23dab136d57a127c566dfba024ade748856356c5a4c21ee37ec685f05252d2b7ea75fbf60c83df5f01788a47d28cb7a9bae119219694d561e77766424f6921afc62db1e16207407f28424c240f8f793aca924e584b3d21e949a74375c85b1b5cafd0c52a4914a0945f474a7b6dba959a65c7757a3ce118708d6c876778efd5c1489a798af80468adc1335fc743c6f41e1cd5f6119ccccf2b1245dc9209e14e3fc204b9eea23712c923f7a3c40f77e04eef362c8fa90d8d63f40183a0cd2ad95f619a44c3e2bae6d160b3c207fa92177f10038d1e04b0c9f6e4734853febde083e7b402ec7426e2e09230e8eae3de59f632771aec542d77537547bca3fd70ca3bbb577662c98fd5c4bcc06fc532cc3a96fd0f5bd33d8b8146d427aaa4957af6669ff8324731bfca24be09a6fdef444a629c6a00e22d884ac02f3769285d6a974fa476d0a0868b2fac185b72f0604917361d32f39edd6a9e9d3d14ad7a331ba0fd4f88cc91890c408bea348b6d7cc84c6fcf60d1460580629c7177e511ae28861550a14b42f6011eb651a2b4300075b57838c72d3c067644cf88e2709db9be399c5ae66da6342b44b0d531d0330d6c02a72d6cd52d43f802a79f4e16d4eb2a53e3beaa7ac0270a9c58ca08a73fa72313bda3d8df571c7e48eb590955cb7159fae0d9ee52db8e4a57f6c556bb3477b65bba7e46ce9f20713250ae7f68cf6fc985eeeeb6dab8455a68cd5d8e5ff2410b9efc73e3965ad50f699771c17d67cac66b6eeff421b0a0896320a0a68f2c9a9b9c74ba0d7947b8cf0dda90fffef22dd5dc222a66966ba2858731740417316f03e1ec327fd85eb5888d7c6dacca3ebe67624e833cc9370d79dc73079c79e03ae84d9edbff993d4d89cd48b649c4b7e1197a75bdfb933126a9d0bf921d43f56ac9861cd83d32f9c7b87855f3742570540b55bc8e26228fd7a3e356c6dcc254db84416f59ea9d55b045a02de9348fddc674575482e052a768a329091f0cb79f38438e0273133f62af0808d13177832aee1e6f6dbf4685ebaf59f843701338d3ccd026d12778f84d6eca1f1db5ef7f5d6e1c9a172d503fbd644d851794a538709dfc415cdaea13f0049edac4d5a56fa7a791ec3c5420e6c39f0b0a83428c09bad0771e122ac73c5444a5523eb80b639dca8479ae1b9731d77ab84981c74ed4c27d71d311e9430cb5eea2facd74f9e7faef30c599db0ca5891dc97cec0bb8251093d07878640f37cad2d4bd6cf902387e83f8b42ac4a2402330b4c019a33b4441b995a4a9259cc4870419b4b4aa4a6d161b5f0f20ff57c8fb72d942f70e9201950abeb096405754c294816cec310910efcd01f9f6a979764cae1314e08c2382f0dd6a277d3b953358c6325595d6e29811641a59a16145c0cd5e470e2ea0530d13c487aa89ed033db5e9e6222a6174f8d40af1d07f0199bad0e78e77a15fbb669bb7fe6211bf7feb1c8675562613f63fdcfb6843cda153030fa3d4ab9f6f37e52337da084ac5b2218920031b1f46ce4c7a6d5e99a6073a387d1fd01ae3975d547892e4f95158c32ac6c74a26690b4c1f09b2ea9cdc4e540797e2af9f7e76d7b73be1c242af10d67359086f6e3848b12fce39e7e274d69ffac731d81f4e6b4abd59424382cc2cf5de2da50a4cd602938590a03030f06a3d5262bd0f230db4ce073e6d5bc6044c1c25acf24bf97af570ba5fe1f55e81e2aa2b8813d477f7dc9e9815dbac4c1a08da0ca49941342aa6e2ad240e3527a03491823987c75d3a66e9ca15ae470db84e828e8e2d4df3dc00aa96fa3b07077212222e49d43be3debe834915911c54c05683efee735d3e1b7f2913bcfcc2d04dc64bb30747eefbc60c67f127d5a56cd86f9dbc9627616739db69bceb76d1f3e534fef84aa8af7206f312dd85f89e04fb187b36fd598c7eac1e0320d00110cf483e47693251e8619c2aea7b81537deb81f5f6464931eb4fd2cf9464973449342fc83d873793811c3e7f00fa5c6335b195a1a9ac094a358776e75cd8a6295b876db82214f7180143f6052bc288afdcfe0a8aa2995dad66dbf8e663e54eff71f33f209a9f7fe4dd4a5bb8e0f294ea0b2f8fc958cce369f56a7c89b5dc8f45fdf345e45da090972427c6f884a3961d345d9b5f56919470b81731953bcd8a7dd7da2bea541752b899792e4df4d4bd70dbf177d6ee9ea965c2665a083a0be317b791851d88835a554b98a04b1309debd026020b6b513c73cf27e44bf1f511b76520007efdfe19c9f4a63def3f2a9e058e0384724428640a0ae848b9bb6a1d9be5f4b6d92bd12aac9c7237966e5d6c48251f50c54db3516338d937dc57bdd7fb99c73270466ecccea8bf4a7745273f7b2c4f3ddd14346ae8793504626e522ca747b8a88e4df5e21a4212081f67f9019abae5d51e5eccb3687cf878028ce8a7883a6807d08fe3435634dca14df7e3fb1ac95012d8718b251708eca0b81ae7d73d28f6f0af78ba2390eab318997c092956bb0ce504ef276f9983acb5b750d4307510e3d3fcae08aa10addbcfb399eea5779b005a3953aebd054b0a4372321621cda868df9266cb70f6e04133540dd142ab6e62a657c8d528a980000e3759c40a6bc4912c0216d49856d8ad2d0757b7322302bc86209b65017855fcca377b40debbaa48181418c28b004eb122f2794c286e73ca0f71c463b81c406108863fa006e5b5f745bca7a0afde1d394f1f9b8bda1ac239f50c3928d4f849e84cbfe66d91497cdd4796126b495f3ba93fc490facfbe160370320897bf99f516b8c8799262c09d4f8202b56039a2b5e082d1aa52beceeed78d9fc508f009b7550acf22416afae86e9b809927950ed6cdd5cc417a39ba4131980856fd2e89b21296dbc40ae7c695292d1fad180c98d22102c2b6abcda96065ae4f644b61831d763ec8e147537048b4b118d3af7a7e3e521f81dbeef25eeb898d02e1786cdb45aebca08760d6b80157d645734e1260966e0691fcad58a9ddc88789a96893033446f4a71b638587feaf52dc76e286896b177ac77aeba97c31bb9cca978a933cdd9e9a0ca36b9936a2805a33a54ee6898ea35bc4797dd6def99da4452e45ac69e41a57b5e5a5b3a756cb0276b5fc89b7ac48aed156fc3176b9124cdf5d10ce01785dcf10bd0224875f2dcfa5ac5718bf291c6114c3ec67f325cbbd75eaa0ac44431cbc6df7a85594ff7a284f559cd4d6928b2e79de0be6a9afea3d357ee4b929e14c1564100e509273dd881d523fb68e6a78467add824d23a557ab9200664b20d040a0f62eafa2d0f57fd9cb49fc78bbde7f68a47d9f36e72ca9885497bbb847c1654163e0cfe11abc4788c9229591bf7c6900b71e342e81a4046a34ea0d9ab0a19b8852d7e9919569585370f0b21c4de91db64ba02706315ac3488d66c7492dcba91937c2a50da00f9b819fe3b9f8af6f9e9280453fbdc50a12e316b1ba7a325e1810e7a6af84e13bb93616fe5e9cbfb0ffbc345c5b5d22d32a0f99e565cdc980da0e6da15b325ac05f37e555233dc08f3bdac6784f11fad044921dd6dcd50b9ef4ce51604e59430a992199b6d15e71dbf4757600a673303c9571e84d0240a8f4d89dc749e20667cbf20e3b11887198e33cb2aac37a5e8648708b301ff828514fd743bf114e5e24e9feb24025818cd6faf013b39841d720699dc796ec39917004aa80ede1e8c1d56153823813047c4bfa5ed96d8e5cc4bb89ac229eab19f787a3756c2d28ed1ee686b7392fb36c6493884ddaece511460f955fadcef8022c660f227989153707a56430256960e3c8e7aaedcb96548b83580a85b95e511c6741624aeb2872c1643112307bd85e9d3426376ab2072e349deeb5603a4f2adb08e9b60e42fcd55ab1cb03beb45e5f5a840ec731c7aee6cbae5eb81e389a177d5d54b8700b0587100e1b1a1d1e84a7573a0c42fa5d2697e94f89636273df15cba13ae484fd9a8c8e905a00cff1f5f6cc9bc0c91e70053309493e73e143de8bb7b419f810b7542eb0040969844637dac23dc296060c2ca3305dd1cf1caddf7675571749c495ec9c4919bbcdbcca8035d13bd7101e72f0fcd75f85301e98eee4a824831dd553d064c70fff7a64a0b42fb7cc4a857023ef0d06e3e68adeaa579e7eb3edc97e7f0e27639c607fc927ab5c896e10e1a91fe06aa842c0ad949aec1d5edc34c9a0bd5f2010f7643d2c268df1efc20b739d5669474431fb35561656b881f0ea0534968b2e81b6a5be4a66e640160fe7980f492035a3c0c44a53ed9734a50e1081c98b67239ffab3b6c768dd764e3895d5ac8ecdb79d657a8f0223e250ed7d01fd3d24936c05865597d33fa465c7d135f546ac86358f8e702413164f65ffe5901baa1cee8cec4688300c4bf25c82dec08afd4753cfaf936ff79dab9c82b1882fcbe8c0a61bdb5da6b597a7d72c6e8b479b598ff21b040536b4893aad08ce82409031c57456a6339ac6788e22e1b566a91a744d45ca93816ead210bbdeaeee1d4b79a515acc889d64436d7b7ae18bc54491862b717f88078eefecf90f10194feba30e6d904764212fcdd918b14099377fed17652dc0f50ac28dca231c4f724983d46175fc96236233bc0a84bf6ca3abcfab03317f58d4d67221ad55a4b7bec6f0e7f8a80245fae3b626f8e9fa9eee1330ed2d545fdc33866cd1f1ef76bee98797be01597bda48cb5c3358cab80b717edd4e561e069a371cccc03392852268214b49d3d944ed312e78770c33b1fb230da8753a37ce04b9daf4e7d5a1272f0fc358f29f14027cc11b676600c67904998eabe6b8e76c7efb76892633e2bbb71fc905168f2164a2401efd2db564dd55650f4e0eda408d00b7369f981917a77e740f1eeeeec8cce43ea63abb8f4f43f22c973e76f37207ff9e9e483bebfcdab82b6b916bdd52a016dcd2a43789c4ebd6894cca954b73e5ec4e781b5d2556ef32e0eec367a5cecb4af56ba3d4ad74cb33c0e09316d94fb75901760086985e5fc090ea4a6cb3931bc5f5ef4fdf13eaa39006340b3621b20d868a0a8957612d8a0000fce72c8e496c1d6e30a04c690f25cd0ff123ba02330050a9218f557761176cd372a5ca31252e698620ea13b5de46d8dd498d75afa967e4c1550d1abaef56bd936f8ec1891280f986e031b7b440b0e5994de62fd64ed7de56f04a92256294b262e72c97ac6bcc4ae72b6f26785f594fd0a2130b83c46751c5049134738375038d015a48676e3021c1e11e69942e1cb7c564e5d15e8cdcc06653c59e41c0a829f0e67859e7a283d9cc82beab01b76abbe21623627835e871c89d852d7e4d09b4c07d5ef26225bfb2cf34fecbcc3f76c6dd2b02dbf230f26c68fc8eddc011b9255fc5d656c9a7f92cff728a2accac0f4dfca477c66303a63e589d2b1421dccba2d42fdfbb7dc8f4075048377b079bb7afbe5bb15ffdb0b8477a2f7cb43869051c56187c0486032eca1b845745b0bdf38746d5812499b837addb6de05b1cae1cf4484263352f852d685dde3412aa6a9b216f65631845a025fb13db1e1d1f45cd826009b36a0ab690262cb44c9d075971fcc66ded9c03b8b4679ae56b3de2f67a6647dc015b0c4a5dd322c3ac0ad98a109b300992a29c3be59ae0d05cf9064cf72460ab0e172938984816225c9a8c00ba3aa2c859c2e4e2ecf82046202ae702f6a10d466bd31c8a85ea392b472409fef9183657fdb18c0675398b2c78dedb7266018d7c2487f7d0291af4f73851df9554c2619cbc762b95817b867d1477c01fbfcc8463715d435fce46ea85ca0cc15efa0bac05e8201f9cb533f1437ce460e5a068fb6f28ed90bce01c73f14ef4010d9d1c29ea7ecbc36936ba94de4548ca355dddab9f97386d8ac1107e2fe381f072500ee4a63420cda2e6683fe3c0eb1b2788da656d46e98c48cb042ab6a58002f51e7417da7b6f5a8af42691a3afaaf7f9a681b988cfd1e254c53f35b8622ee570cb7cc3cacfc62ea6d609867a1c2faa2a85cc37cd6a1e5fa263653997d402d26b7050311cdb9ec70938b9ce414c57fa40355a5145212a54cbabd003423dd25e619cd3ee1d75aa0fb7557bf73f358b0a70f477d7bcf90f50b53398ffafde1fb42eded7b39a36c009ff0b079aa8ada477449a299674ce91308f27c05a90516c20f7c0d1cf82124ea2b157035b9f3a6303be7def6cce84047939382bea94cd3dd1d723c09e51cb48ee70329a5b837770145423e033681420afffecb9d7bc7ea870bdf1124d427c37d404fd4e5f430ce822178e6716551a36909d2245b1fc4f6957b309722e8e4bb2effc282cacdabf26c15d38f317fbdc46f5a991ae3f25a2f2fcbc96ec0a969f6518ded2cb9c34768dbd3534301f1f0b5c92da5484914468341a4e06eb103b2585eef4d7fd458d6365a385de805ab4e205c800028317a992dc9068491eb6fca7d10cb0fb5b2dbedec14b764306b7ead0a363893dbc98de0c6f1ce2a53e40acf3b8f133982d37c7f99b47b391a17e1eb93e30a73a50c410afc6f2a87910412e0ec2c7d8e2c89fd3a06424a3294bc3dd6f791a4a665ba5d3b7266306866d81a854559cea4bd6d39057033782676a28b59150ea2ff78365839e9e872f604ff6a93abd5f09ea8206da0c148b7b46844bc84150153e57f98046c694d36ede3a7263a4b19fa8b102fdfc191e264678c592499b2e86d71efa0de868a1e1d9520a8cbbd22f0f87088802c1edb9cfe1c101c175fc6dddd7e3d3fd22cd59b7f2a5133c2d8dafab5276a7fe189c463355ac478ffdaffd034f9f844996901c4f8c8d0d1fe19ac499ec4acd82328d6b4b884c48f56518895b475edc2b0882c5b544be92d2e306f3afa81dd25f6f3e5612a750595fb4123baa4de692e38a3c6b39f9935eacfee22039a24db0a12f8e8bf04c456b4a2adb2e858e53a306757fa3aa678013a0cc497694912e653463f5fe719e4344bf3c3ee89ded9a3c0c3cbb3bc3fabc7b62172e0d16ae927d627de70b65b8abcea9510d4aee89ffdde2ebdada532466b8af54cd47752d56267797d433bf554a7e3cc0d09e3e43185aec7e81a256708b79397e1a6fbb259f915a199041b51c55fbb3e95d3378c4358bbf6a41c5731eae66ea22d929e3a2c591b4150d6ade0ffed0be6671d5bafda60a391bf6ba3a710c4184672b5028adcc2e0daf31ccdfd6385ae073585b59f7294aa0517e8cbcf6143395bd2192d860cdb4e4c1e13988005704b39565e6f1f3f80b19d76944d71e8b56e60079163dd59df76c18980480de1969c11c03bd93dfcee48669655afe2bedffbf897095c4cb8726c1efc03711b470bab411469fcf9f7c237a2819116308a2dbd2fb502d085605bdd9e9144ba48b86cd8cba277d07c264fce4fddabe8535d73c74198cf1cab42b98bbebb95ceb9ab4359ab2c0c0d9f69e8b27e24aab29243099d7c65c4b52b9c53e717953d96cc9f212bb9bea762b25a546943bc950399ef04c891032ab22706710ff41039e7c153babde372360477bc458a537bd8ca0afa985a1d77990079c813f73c64b252df3822e93456e86550dc49c205139d3a6d4f9ee6bcb8ed7c9b427eb9d419b692261fe4500f6c002071778f6325f98061144c49d215e92e302216a695863e231081c0f34a2310ce9b345e469757a8ab9150d1b85f963724595908daa70cf27d3c2d7904e39dd29e45b516a2a9bd22292a84f1f72fc615e39c9476491e58bba835218002068d4f8907f7cf37a39c34c0282f11c0b3c4a538c592effebad7c9061d9f53e175f5cadde397d6aba06a010a2bca80a398b9b5a2b8ad4b7fccbbb0b2cb4c9b672ceeff2c7cd211ccfae7d638fe1a7dad41e84d900e74faa3f168d3607cc4424077e329dfbcf7cf9d98d9eb3ffe0cff35c306fd8ebd0035733fbecabc27c36ee5f2b818ef6e101db26462a4c825e1fc9eae6ec5a6009d7d50cfaa65b1f7fa837129c68214607b195e8cf9488685fd69550cbccf83c701570b234df8d13ecb8f38fe6fff93e5768019b4fd69a5022d1cb9222051c96cc53da2f63f14c8f7d8b1e893d92f7528f37f896b07c21cba4480b7312f4d9461ee87daba16e4723b41812c48e0274c75a067147dfcef362cc1288972d036be6d5fa504fb1fde5837bfc506c22e46d4e85d0d97a1afb6a8b9969d747b044801238f1078200093a531fe6f92bda632f6e87e759a8d47e9838e8dea49221152b2a01ec10ae7eaf431ddab3fcf4c2ceec47e02b3b709802396598538bcfb9')
                            decrypted_out_data = decrypt(encrypted_out_data)
                            print('Sending data: {}'.format(decrypted_out_data))
                            connection.sendall(encrypted_out_data)
                            out_data_len = binascii.unhexlify('8e000000')
                            print('Sending data length: {:d}'.format(int.from_bytes(out_data_len,"little")))
                            connection.sendall(out_data_len)
                            time.sleep(5.0)
                            encrypted_out_data = binascii.unhexlify('d3f637f825a47a9664a5e54d38d27ca533c3116048c1aba2059109466f66793b5d567ca5b520bd9f2e58e5f26b4f98d6722aac4fb461fdd4305e986c32614deb')
                            decrypted_out_data = decrypt(encrypted_out_data)
                            print('Sending data: {}'.format(decrypted_out_data))
                            connection.sendall(encrypted_out_data)
                else:
                    print('no more data from', client_address)
                    break
                
        finally:
            # Clean up the connection
            connection.close()

if __name__ == '__main__':
    main()